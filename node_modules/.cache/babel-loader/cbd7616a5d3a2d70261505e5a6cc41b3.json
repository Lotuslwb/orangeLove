{"ast":null,"code":"import _objectSpread from \"@babel/runtime-corejs2/helpers/esm/objectSpread\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _wrapNativeSuper from \"@babel/runtime-corejs2/helpers/esm/wrapNativeSuper\";\nimport superagentPromise from 'superagent-promise';\nimport _superagent from 'superagent';\nimport storage from \"./storage\";\nvar superagent = superagentPromise(_superagent, global.Promise);\nvar encode = encodeURIComponent;\n\nvar getAppParams = function getAppParams() {\n  var userInfo = storage.UserInfo.get();\n  var params = {};\n\n  if (userInfo) {\n    params.tk = userInfo.token || '';\n  }\n\n  return params;\n};\n\nvar MyError =\n/*#__PURE__*/\nfunction (_Error) {\n  _inherits(MyError, _Error);\n\n  function MyError(code, message) {\n    var _this;\n\n    _classCallCheck(this, MyError);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(MyError).call(this));\n    _this.code = 0;\n    _this.message = message;\n    _this.code = code;\n    return _this;\n  }\n\n  return MyError;\n}(_wrapNativeSuper(Error));\n\nvar tokenPlugin = function tokenPlugin(req) {// const tk = getCachedToken();\n  // if (tk) {\n  //     req.set('authorization', `Token ${tk}`);\n  // }\n};\n\nvar handleErrors = function handleErrors(err) {\n  if (err && err.response && err.response.status === 401) {}\n\n  return err;\n};\n\nvar responseBody = function responseBody(res) {\n  var body = res.body;\n\n  if (body.flag === 1 || body.code === 0) {\n    return body.data;\n  }\n\n  throw new MyError(body.flag, body.message);\n};\n\nvar requests = {\n  del: function del(url, body, params) {\n    return superagent.del(\"\".concat(url), body).query(_objectSpread({}, params, getAppParams())).use(tokenPlugin).end(handleErrors).then(responseBody);\n  },\n  get: function get(url, params) {\n    return superagent.get(\"\".concat(url)).query(_objectSpread({}, params, getAppParams())).use(tokenPlugin).end(handleErrors).then(responseBody);\n  },\n  put: function put(url, body) {\n    return superagent.put(\"\".concat(url), body).query(_objectSpread({}, params, getAppParams())).use(tokenPlugin).end(handleErrors).then(responseBody);\n  },\n  post: function post(url, body, params) {\n    return superagent.post(\"\".concat(url), body).query(_objectSpread({}, params, getAppParams())).use(tokenPlugin).end(handleErrors).then(responseBody);\n  }\n};\n\nvar limit = function limit(count, p) {\n  return \"limit=\".concat(count, \"&offset=\").concat(p ? p * count : 0);\n};\n\nvar host = 'http://47.99.64.137:8080/evaluation'; // const host = 'http://localhost:8080/evaluation';\n\nvar Wechat = {\n  getConfig: function getConfig() {\n    return requests.get(\"\".concat(host, \"/wx_mp/config\"));\n  },\n  getAuthorizationUrl: function getAuthorizationUrl() {\n    return requests.get(\"\".concat(host, \"/wx_mp/auth_url\"));\n  },\n  login: function login(code, fromId) {\n    return requests.get(\"\".concat(host, \"/wx_mp/login?\").concat(fromId ? \"fromId=\".concat(fromId) : ''), {\n      code: code\n    });\n  }\n};\nvar Baby = {\n  add: function add(params) {\n    return requests.post(\"\".concat(host, \"/baby\"), params);\n  },\n  get: function get() {\n    return requests.get(\"\".concat(host, \"/baby\"));\n  },\n  getReport: function getReport() {\n    return requests.get(\"\".concat(host, \"/baby/report\"));\n  }\n};\nvar Question = {\n  getList: function getList() {\n    return requests.get(\"\".concat(host, \"/question/list\"));\n  },\n  answer: function answer(questionId, _answer) {\n    return requests.post(\"\".concat(host, \"/question/\").concat(questionId, \"/answer/\").concat(_answer));\n  },\n  answerList: function answerList(params) {\n    return requests.post(\"\".concat(host, \"/question/answer\"), params);\n  }\n};\nvar Answer = {\n  getList: function getList() {\n    return requests.get(\"\".concat(host, \"/answer/list\"));\n  }\n};\nvar Report = {\n  getByAttr: function getByAttr(attrId) {\n    return requests.get(\"\".concat(host, \"/report/attr/\").concat(attrId));\n  }\n};\nexport default {\n  Wechat: Wechat,\n  Baby: Baby,\n  Question: Question,\n  Answer: Answer,\n  Report: Report\n};","map":{"version":3,"sources":["/Users/lotuslwb/Documents/MJobs/orangeLove/utils/agent.js"],"names":["superagentPromise","_superagent","storage","superagent","global","Promise","encode","encodeURIComponent","getAppParams","userInfo","UserInfo","get","params","tk","token","MyError","code","message","Error","tokenPlugin","req","handleErrors","err","response","status","responseBody","res","body","flag","data","requests","del","url","query","use","end","then","put","post","limit","count","p","host","Wechat","getConfig","getAuthorizationUrl","login","fromId","Baby","add","getReport","Question","getList","answer","questionId","answerList","Answer","Report","getByAttr","attrId"],"mappings":"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","sourcesContent":["import superagentPromise from 'superagent-promise';\nimport _superagent from 'superagent';\nimport storage from \"./storage\";\n\nconst superagent = superagentPromise(_superagent, global.Promise);\n\nconst encode = encodeURIComponent;\n\n\nconst getAppParams = () => {\n    const userInfo = storage.UserInfo.get();\n    const params = {};\n    if (userInfo) {\n        params.tk = userInfo.token || '';\n    }\n    return params;\n};\n\nclass MyError extends Error {\n    code = 0;\n\n    constructor(code, message) {\n        super();\n        this.message = message;\n        this.code = code;\n    }\n}\n\nconst tokenPlugin = req => {\n    // const tk = getCachedToken();\n    // if (tk) {\n    //     req.set('authorization', `Token ${tk}`);\n    // }\n};\n\nconst handleErrors = err => {\n    if (err && err.response && err.response.status === 401) {}\n    return err;\n};\n\nconst responseBody = (res) => {\n    const body = res.body;\n    if (body.flag === 1 || body.code === 0) {\n        return body.data;\n    }\n    throw new MyError(body.flag, body.message);\n};\n\nconst requests = {\n    del: (url, body, params) =>\n        superagent\n        .del(`${url}`, body)\n        .query({\n            ...params,\n            ...getAppParams()\n        })\n        .use(tokenPlugin)\n        .end(handleErrors)\n        .then(responseBody),\n    get: (url, params) =>\n        superagent\n        .get(`${url}`)\n        .query({\n            ...params,\n            ...getAppParams()\n        })\n        .use(tokenPlugin)\n        .end(handleErrors)\n        .then(responseBody),\n    put: (url, body) =>\n        superagent\n        .put(`${url}`, body)\n        .query({\n            ...params,\n            ...getAppParams()\n        })\n        .use(tokenPlugin)\n        .end(handleErrors)\n        .then(responseBody),\n    post: (url, body, params) =>\n        superagent\n        .post(`${url}`, body)\n        .query({\n            ...params,\n            ...getAppParams()\n        })\n        .use(tokenPlugin)\n        .end(handleErrors)\n        .then(responseBody),\n};\n\nconst limit = (count, p) => `limit=${count}&offset=${p ? p * count : 0}`;\n\nconst host = 'http://47.99.64.137:8080/evaluation';\n// const host = 'http://localhost:8080/evaluation';\n\nconst Wechat = {\n    getConfig: () => {\n        return requests.get(`${host}/wx_mp/config`);\n    },\n    getAuthorizationUrl: () => {\n        return requests.get(`${host}/wx_mp/auth_url`);\n    },\n    login: (code, fromId) => {\n        return requests.get(`${host}/wx_mp/login?${fromId ? `fromId=${fromId}` : ''}`, {\n            code\n        });\n    }\n};\n\nconst Baby = {\n    add: (params) => {\n        return requests.post(`${host}/baby`, params);\n    },\n    get: () => {\n        return requests.get(`${host}/baby`);\n    },\n    getReport: () => {\n        return requests.get(`${host}/baby/report`);\n    }\n};\n\nconst Question = {\n    getList: () => {\n        return requests.get(`${host}/question/list`);\n    },\n    answer: (questionId, answer) => {\n        return requests.post(`${host}/question/${questionId}/answer/${answer}`);\n    },\n    answerList: (params) => {\n        return requests.post(`${host}/question/answer`, params);\n    }\n};\n\nconst Answer = {\n    getList: () => {\n        return requests.get(`${host}/answer/list`);\n    }\n};\n\nconst Report = {\n    getByAttr: attrId => {\n        return requests.get(`${host}/report/attr/${attrId}`);\n    }\n};\n\nexport default {\n    Wechat,\n    Baby,\n    Question,\n    Answer,\n    Report,\n};"]},"metadata":{},"sourceType":"module"}