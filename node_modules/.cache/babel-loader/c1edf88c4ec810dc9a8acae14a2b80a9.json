{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport React, { Component } from 'react';\nimport ReactDOM from 'react-dom';\nimport Head from 'next/head';\nimport agent from \"../utils/agent\";\nimport Router from 'next/router';\nimport storage from \"../utils/storage\";\nimport { isWeixinBrowser } from \"../utils/utils\";\n\nvar PageWrapper = function PageWrapper(ComposedComponent) {\n  var AppLayout =\n  /*#__PURE__*/\n  function (_Component) {\n    _inherits(AppLayout, _Component);\n\n    function AppLayout(props) {\n      _classCallCheck(this, AppLayout);\n\n      return _possibleConstructorReturn(this, _getPrototypeOf(AppLayout).call(this, props));\n    }\n\n    _createClass(AppLayout, [{\n      key: \"componentDidMount\",\n      value: function componentDidMount() {\n        var query = this.props.query;\n        var user = storage.UserInfo.get();\n        var isWeixin = isWeixinBrowser();\n        this.setState({\n          isWeixin: isWeixin\n        });\n\n        if (!user) {\n          if (isWeixin) {\n            if (!query.code) {\n              agent.Wechat.getAuthorizationUrl().then(function (data) {\n                console.log(data);\n                Router.replace(data);\n              });\n            } else {\n              agent.Wechat.login(query.code, query.fromId).then(function (data) {\n                storage.UserInfo.set(data);\n                agent.Wechat.getConfig().then(function (config) {\n                  config.jsApiList = ['onMenuShareAppMessage'];\n                  wx.config(config);\n                  wx.ready(function () {\n                    //需在用户可能点击分享按钮前就先调用\n                    wx.onMenuShareAppMessage({\n                      title: '橙爱天赋测评',\n                      // 分享标题\n                      desc: '测测你的孩子有哪些独一无二的天赋',\n                      // 分享描述\n                      link: 'http://house.t.gegosport.com?fromId=' + data.userId,\n                      // 分享链接，该链接域名或路径必须与当前页面对应的公众号JS安全域名一致\n                      imgUrl: '',\n                      // 分享图标\n                      success: function success() {// 设置成功\n                      }\n                    });\n                  });\n                });\n              });\n            }\n          }\n        } else {\n          agent.Wechat.getConfig().then(function (config) {\n            config.jsApiList = ['onMenuShareAppMessage'];\n            wx.config(config);\n            wx.ready(function () {\n              //需在用户可能点击分享按钮前就先调用\n              wx.onMenuShareAppMessage({\n                title: '橙爱天赋测评',\n                // 分享标题\n                desc: '测测你的孩子有哪些独一无二的天赋',\n                // 分享描述\n                link: 'http://house.t.gegosport.com?fromId=' + user.userId,\n                // 分享链接，该链接域名或路径必须与当前页面对应的公众号JS安全域名一致\n                imgUrl: '',\n                // 分享图标\n                success: function success() {// 设置成功\n                }\n              });\n            });\n          });\n        } // if (isWeixin) {\n        //     agent.Wechat.getConfig()\n        //         .then(data => {\n        //             // data.debug = true;\n        //             data.jsApiList = [\n        //                 'chooseImage'\n        //             ];\n        //             wx.config(data);\n        //             wx.checkJsApi({\n        //                 jsApiList: ['chooseImage'], // 需要检测的JS接口列表，所有JS接口列表见附录2,\n        //                 success: function (res) {\n        //                 }\n        //             });\n        //         });\n        // }\n\n      }\n    }, {\n      key: \"render\",\n      value: function render() {\n        return React.createElement(\"div\", null, React.createElement(Head, null, React.createElement(\"script\", {\n          src: \"https://res.wx.qq.com/open/js/jweixin-1.3.2.js\"\n        })), React.createElement(ComposedComponent, this.props));\n      }\n    }], [{\n      key: \"getInitialProps\",\n      value: function () {\n        var _ref = _asyncToGenerator(\n        /*#__PURE__*/\n        _regeneratorRuntime.mark(function _callee(_ref2) {\n          var res, query;\n          return _regeneratorRuntime.wrap(function _callee$(_context) {\n            while (1) {\n              switch (_context.prev = _context.next) {\n                case 0:\n                  res = _ref2.res, query = _ref2.query;\n                  return _context.abrupt(\"return\", {\n                    query: query\n                  });\n\n                case 2:\n                case \"end\":\n                  return _context.stop();\n              }\n            }\n          }, _callee);\n        }));\n\n        function getInitialProps(_x) {\n          return _ref.apply(this, arguments);\n        }\n\n        return getInitialProps;\n      }()\n    }]);\n\n    return AppLayout;\n  }(Component);\n\n  return AppLayout;\n};\n\nexport default PageWrapper;","map":{"version":3,"sources":["/Users/lotuslwb/Documents/MJobs/orangeLove/components/PageWrapper.js"],"names":["React","Component","ReactDOM","Head","agent","Router","storage","isWeixinBrowser","PageWrapper","ComposedComponent","AppLayout","props","query","user","UserInfo","get","isWeixin","setState","code","Wechat","getAuthorizationUrl","then","data","console","log","replace","login","fromId","set","getConfig","config","jsApiList","wx","ready","onMenuShareAppMessage","title","desc","link","userId","imgUrl","success","res"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\nimport ReactDOM from 'react-dom';\nimport Head from 'next/head';\nimport agent from '@utils/agent';\nimport Router from 'next/router'\nimport storage from '@utils/storage';\nimport {isWeixinBrowser} from '@utils/utils';\n\nconst PageWrapper = (ComposedComponent) => {\n    class AppLayout extends Component {\n\n        constructor(props) {\n            super(props);\n        }\n\n        static async getInitialProps({res, query}) {\n            return {\n                query\n            };\n        }\n\n        componentDidMount() {\n            const {query} = this.props;\n            const user = storage.UserInfo.get();\n            const isWeixin = isWeixinBrowser();\n            this.setState({\n                isWeixin\n            });\n            if (!user) {\n                if (isWeixin) {\n                    if (!query.code) {\n                        agent.Wechat.getAuthorizationUrl()\n                            .then(data => {\n                                console.log(data);\n                                Router.replace(data);\n                            })\n                    } else {\n                        agent.Wechat.login(query.code, query.fromId)\n                            .then(data => {\n                                storage.UserInfo.set(data);\n                                agent.Wechat.getConfig().then(config => {\n                                    config.jsApiList = ['onMenuShareAppMessage'];\n                                    wx.config(config);\n                                    wx.ready(function () {   //需在用户可能点击分享按钮前就先调用\n                                        wx.onMenuShareAppMessage({\n                                            title: '橙爱天赋测评', // 分享标题\n                                            desc: '测测你的孩子有哪些独一无二的天赋', // 分享描述\n                                            link: 'http://house.t.gegosport.com?fromId=' + data.userId, // 分享链接，该链接域名或路径必须与当前页面对应的公众号JS安全域名一致\n                                            imgUrl: '', // 分享图标\n                                            success: function () {\n                                                // 设置成功\n                                            }\n                                        })\n                                    });\n                                })\n                            });\n                    }\n                }\n            } else {\n                agent.Wechat.getConfig().then(config => {\n                    config.jsApiList = ['onMenuShareAppMessage'];\n                    wx.config(config);\n                    wx.ready(function () {   //需在用户可能点击分享按钮前就先调用\n                        wx.onMenuShareAppMessage({\n                            title: '橙爱天赋测评', // 分享标题\n                            desc: '测测你的孩子有哪些独一无二的天赋', // 分享描述\n                            link: 'http://house.t.gegosport.com?fromId=' + user.userId, // 分享链接，该链接域名或路径必须与当前页面对应的公众号JS安全域名一致\n                            imgUrl: '', // 分享图标\n                            success: function () {\n                                // 设置成功\n                            }\n                        })\n                    });\n                })\n            }\n            // if (isWeixin) {\n            //     agent.Wechat.getConfig()\n            //         .then(data => {\n            //             // data.debug = true;\n            //             data.jsApiList = [\n            //                 'chooseImage'\n            //             ];\n            //             wx.config(data);\n            //             wx.checkJsApi({\n            //                 jsApiList: ['chooseImage'], // 需要检测的JS接口列表，所有JS接口列表见附录2,\n            //                 success: function (res) {\n            //                 }\n            //             });\n            //         });\n            // }\n        }\n\n        render() {\n            return (\n                <div>\n                    <Head>\n                        <script src=\"https://res.wx.qq.com/open/js/jweixin-1.3.2.js\"></script>\n                    </Head>\n                    <ComposedComponent {...this.props} />\n                </div>\n            );\n        }\n    }\n\n    return AppLayout;\n};\n\nexport default PageWrapper;\n"]},"metadata":{},"sourceType":"module"}